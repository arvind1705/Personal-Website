<!DOCTYPE html><html>
<!-- Mirrored from christopher.su/2012/automatically-committing-git-textmate/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 02 Aug 2017 17:06:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"><title>Automatically Committing to Git in TextMate - Christopher Su</title><script src="../../cdn-cgi/apps/head/Md70coOFj-W1ipSNpRLrMg41doI.js"></script><link rel="stylesheet" href="../../public/css/custom.css"><link href="https://fonts.googleapis.com/css?family=Open+Sans:700,400|Droid+Serif:400,700,400italic" rel="stylesheet" type="text/css"><link rel="shortcut icon" href="../../public/favicon.ico"><link rel="alternate" type="application/rss+xml" title="RSS" href="../../atom.xml"></head><body><div class="container content"><div class="masthead"><h3 class="masthead-title"><a href="../../index.html" title="Home">Christopher Su</a> <span class="top-nav nav-bar"><span class="top-nav-item"><a href="../../about/index.html" title="About">About</a></span> <span class="top-nav-item"><a href="../../projects/index.html" title="Projects">Projects</a></span> <span class="top-nav-item"><a href="../../contact/index.html" " title="Contact">Contact</a></span> <span class="top-nav-item"><a href="../../index/index.html" title="More">More</a></span></span></h3></div> <nav id="breadcrumb-nav" class="nav-bar"><span class="csu-breadcrumb"><a href="../../index.html">Home</a></span><ol class="csu-breadcrumbs" vocab="http://schema.org/" typeof="BreadcrumbList"><li class="csu-breadcrumb" property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" href="../../blog/index.html"><span property="name">Blog</span></a><meta property="position" content="1"></li> <li class="csu-breadcrumb active" property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" href="index.html"><span property="name">Automatically Committing to Git in TextMate</span></a><meta property="position" content="2"></li></ol></nav> <div class="post"><div class="post-header"><h1 class="post-title">Automatically Committing to Git in TextMate</h1><span class="post-date">December 6, 2012</span></div><div class="post-content"><p>With my Gollum installation and Jekyll powered website, I often commit changes after saving a file. This two-step process can be reduced to a single step by having TextMate commit to git automatically after a file save. This is done by going to “Bundles” in the menubar, going to Bundle Editor &gt; Edit Commands…, creating a new command to save and commit to git, and assigning it a keyboard shortcut.</p>

<p>Here is the command that I use:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#!/usr/bin/env ruby</span>
<span class="n">filename</span> <span class="o">=</span> <span class="no">ENV</span><span class="p">[</span><span class="s2">"TM_FILEPATH"</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="s2">"/"</span><span class="p">).</span><span class="nf">last</span>
<span class="sb">`git add </span><span class="si">#{</span><span class="no">ENV</span><span class="p">[</span><span class="s2">"TM_FILEPATH"</span><span class="p">]</span><span class="si">}</span><span class="sb">`</span>
<span class="sb">`git commit -m "Updated </span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="sb"> (TextMate)"`</span>
</code></pre>
</div>

<p>I set the command to save the “Current File” and input the “Entire Document”. I assigned the key-binding to Commmand+S because I intend on committing almost every file I save. To have the command request a commit message for the commit, this command can be used, which displays a pop up dialog requesting a message:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">#!/usr/bin/env ruby</span>
<span class="n">filename</span> <span class="o">=</span> <span class="no">ENV</span><span class="p">[</span><span class="s2">"TM_FILEPATH"</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="s2">"/"</span><span class="p">).</span><span class="nf">last</span>

<span class="nb">require</span> <span class="no">ENV</span><span class="p">[</span><span class="s1">'TM_SUPPORT_PATH'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">'/lib/ui'</span>
<span class="n">message</span> <span class="o">=</span> <span class="no">TextMate</span><span class="o">::</span><span class="no">UI</span><span class="p">.</span><span class="nf">request_string</span><span class="p">(</span><span class="ss">:title</span> <span class="o">=&gt;</span> <span class="s2">"Commiting changes of </span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="ss">:prompt</span> <span class="o">=&gt;</span> <span class="s2">"Please enter the commit message for your changes."</span><span class="p">)</span>

<span class="n">add</span> <span class="o">=</span> <span class="sb">`git add </span><span class="si">#{</span><span class="no">ENV</span><span class="p">[</span><span class="s2">"TM_FILEPATH"</span><span class="p">]</span><span class="si">}</span><span class="sb"> 2&gt;&amp;1`</span>
<span class="n">commit</span> <span class="o">=</span> <span class="sb">`git commit -m "</span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="sb">" 2&gt;&amp;1`</span>

<span class="n">git_answer</span> <span class="o">=</span> <span class="n">add</span> <span class="o">+</span> <span class="n">commit</span>
<span class="k">unless</span> <span class="n">git_answer</span><span class="p">.</span><span class="nf">grep</span><span class="p">(</span><span class="sr">/fatal/</span><span class="p">).</span><span class="nf">empty?</span>
  <span class="nb">puts</span> <span class="s2">"Please initialize git repository first!"</span>
<span class="k">end</span>
</code></pre>
</div>
</div></div><hr><div class="post-footer"><div id="comments"><h3>Comments</h3> <div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="christophersu";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><div class="footer"><p class="copyright">&copy; 2012-2017 Christopher Su. All rights reserved.</p></div></div><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","../../../www.google-analytics.com/analytics.js","ga"),ga("create","UA-34248999-1","auto"),ga("send","pageview");</script> </body>
<!-- Mirrored from christopher.su/2012/automatically-committing-git-textmate/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 02 Aug 2017 17:06:50 GMT -->
</html>